<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="description" content="Read BIPs like a pro." />
    <meta name="keywords" content="bitcoin, bitcoin improvement proposals, bip, bips, static, share" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta property="og:title" content="BIP 321: URI Scheme" />
    <meta property="og:description" content="Read BIPs like a pro." />
    <meta property="og:image" content="https://bips.dev/og-bips-dev.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="BIP 321: URI Scheme" />
    <meta name="twitter:description" content="Read BIPs like a pro." />
    <meta name="twitter:creator" content="@nickmonad" />
    <meta name="twitter:image" content="https://bips.dev/og-bips-dev.png" />

    <title>BIP 321: URI Scheme</title>

    
        <link rel="stylesheet" href="/style.css" />
    

    <link rel="stylesheet" href="/pagefind/pagefind-ui.css" />
    <script src="/pagefind/pagefind-ui.js"></script>

    <script defer data-domain="bips.dev" src="/js/script.js"></script>
    <script>
        // setup plausible function for custom events
        window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }

        // setup and initialize dark mode
        // https://tailwindcss.com/docs/dark-mode
        window.setTheme = function() {
            if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark')
            } else {
                document.documentElement.classList.remove('dark')
            }
        }
        window.setTheme();

        // searching via
        // https://pagefind.app
        window.addEventListener('DOMContentLoaded', function(event) {
            new PagefindUI({
                element: "#search",
                hightlightParam: "highlight",
                showImages: false,
                showSubResults: true,
                translations: {
                    placeholder: "Search BIPs"
                },
                processTerm: function(term) {
                    plausible('Search');
                    return term;
                }
            });
        });
    </script>

    <style>
        /* variables to override on pagefind */
        /* https://pagefind.app/docs/ui-usage/#customising-the-styles */
        /* values are from tailwind: https://tailwindcss.com/docs/customizing-colors */
        :root {
            --pagefind-ui-primary: #334155;
            --pagefind-ui-text: #334155;
            --pagefind-ui-background: #ffffff;
            --pagefind-ui-border-width: 1px;
            --pagefind-ui-border-radius: 4px;
        }

        html.dark {
            --pagefind-ui-primary: #d1d5db;
            --pagefind-ui-text: #d1d5db;
            --pagefind-ui-background: #18181b;
            --pagefind-ui-border: #152028;
        }

        mark {
            background-color: #ff9900 !important;
            color: #6b7280 !important;
        }
    </style>
</head>

<body class="bg-white dark:bg-zinc-900">
    <div class="container mx-auto flex justify-center">
        <div data-pagefind-body class="min-w-full max-w-full lg:min-w-[1000px] lg:max-w-[1000px] px-6 py-10 space-y-10 text-slate-700 dark:text-gray-300">
            
    <div class="flex flex-col space-y-4 pt-4 md:pt-8">
        <div class="flex justify-between">
            <a href="/">Back to BIPs</a>
            <div class="flex">
                <svg id="toggleDark_light" class="hidden dark:flex w-6 h-6 hover:cursor-pointer" onclick="localStorage.theme = 'light'; window.setTheme()"
                        xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
                </svg>
                <svg id="toggleDark_dark" class="flex dark:hidden w-6 h-6 hover:cursor-pointer" onclick="localStorage.theme = 'dark'; window.setTheme()"
                        xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" />
                </svg>
            </div>
        </div>
        <div class="flex flex-col space-y-2">
            <div data-pagefind-weight="10" class="text-2xl font-extrabold">BIP 321: URI Scheme</div>
            <div class="flex justify-between">
                <div class="text-xl font-semibold">2024-11-15</div>
                <a href="https:&#x2F;&#x2F;github.com&#x2F;bitcoin&#x2F;bips&#x2F;blob&#x2F;master&#x2F;bip-0321.mediawiki" target="_blank">View on GitHub</a>
            </div>
        </div>

        <article class="max-w-none prose prose-lg prose-zinc prose-p:leading-relaxed prose-a:font-bold prose-a:underline prose-a:decoration-2 prose-a:decoration-bitcoin prose-pre:bg-zinc-200 prose-pre:text-zinc-800 dark:prose-invert dark:prose-pre:bg-zinc-600 dark:prose-pre:text-white">
            <pre><code>  BIP: 321
  Layer: Applications
  Title: URI Scheme
  Author: Matt Corallo &lt;bip21@bluematt.me&gt;
  Comments-Summary: No comments yet.
  Comments-URI: https:&#x2F;&#x2F;github.com&#x2F;bitcoin&#x2F;bips&#x2F;wiki&#x2F;Comments:BIP-0321
  Status: Proposed
  Type: Standards Track
  Created: 2024-11-15
  License: BSD-2-Clause
  Replaces: 21
</code></pre>
<h2> Copyright </h2>
<p>This BIP is licensed under the BSD 2-clause license.</p>
<h2> Abstract </h2>
<p>This BIP proposes a URI scheme for describing Bitcoin payment instructions.</p>
<h2> Motivation </h2>
<p>The purpose of this URI scheme is to enable users to easily make payments by simply clicking links on webpages or scanning QR Codes.</p>
<p>This BIP is a modification and intended replacement of <a href="/21" target="_blank">BIP 0021</a> to add information about the modern usage of bitcoin: URIs (including standard query parameters and modern address types) as well as provide forward-looking guidance on how to incorporate new payment instructions. It further adds an optional extension to provide the payment initiator with proof of payment. BIP 21 was based on BIP 20, which was, in turn based on an earlier document by Nils Schneider.</p>
<h2> Specification </h2>
<h3> General rules for handling (important!) </h3>
<p>Bitcoin clients MUST NOT act on URIs without getting the user's authorization.
They SHOULD require the user to manually approve each payment individually, though in some cases they MAY allow the user to automatically make this decision.</p>
<h3> Operating system integration </h3>
<p>Graphical bitcoin clients SHOULD register themselves as the handler for the &quot;bitcoin:&quot; URI scheme by default, if no other handler is already registered. If there is already a registered handler, they MAY prompt the user to change it once when they first run the client.</p>
<h3> General Format </h3>
<p>Bitcoin URIs follow the general format for URIs as set forth in RFC 3986. The path component consists of a bitcoin address, and the query component provides additional payment options.</p>
<p>Elements of the query component may contain characters outside the valid range. These must first be encoded according to UTF-8, and then each octet of the corresponding UTF-8 sequence must be percent-encoded as described in RFC 3986.</p>
<h3> ABNF grammar </h3>
<pre><code> bitcoinurn     = &quot;bitcoin:&quot; [ bitcoinaddress ] [ &quot;?&quot; bitcoinparams ]
 bitcoinaddress = *base58 &#x2F; *bech32 &#x2F; *bech32m
 bitcoinparams  = bitcoinparam [ &quot;&amp;&quot; bitcoinparams ]
 bitcoinparam   = [ amountparam &#x2F; labelparam &#x2F; messageparam &#x2F; responseparam &#x2F; otherparam &#x2F; reqparam ]
 amountparam    = &quot;amount=&quot; *digit [ &quot;.&quot; *digit ]
 labelparam     = &quot;label=&quot; *qchar
 messageparam   = &quot;message=&quot; *qchar
 responseparam  = [ &quot;req-&quot; ] &quot;pop=&quot; *qchar
 otherparam     = qchar *qchar [ &quot;=&quot; *qchar ]
 reqparam       = &quot;req-&quot; qchar *qchar [ &quot;=&quot; *qchar ]
</code></pre>
<p>Here, &quot;qchar&quot; corresponds to valid characters of an RFC 3986 URI query component, excluding the &quot;=&quot; and &quot;&amp;&quot; characters, which this BIP takes as separators.</p>
<p>The scheme component (&quot;bitcoin:&quot;) is case-insensitive, and implementations must accept any combination of uppercase and lowercase letters. The query parameter keys are also case-insensitive. Query parameter values and bitcoin address fields may be case-sensitive depending on their content.</p>
<p>Multiple query parameters with the same key MAY be included for query parameters representing payment instructions. Multiple query parameters with the same key MUST NOT be included for keys &quot;label&quot;, &quot;message&quot;, or &quot;pop&quot;. Multiple query parameters with the same key for other keys MUST be allowed for unknown query parameters. Future query parameter keys may or may not allow for duplicate parameters.</p>
<h3> Bitcoin Address </h3>
<p>The bitcoinaddress body MUST be either a base58 P2SH or P2PKH address, bech32 Segwit version 0 address, bech32m Segwit address, or empty. Future address formats SHOULD instead be placed in query keys as optional payment instructions to provide backwards compatibility during upgrade cycles. The bitcoinaddress part of the URI MAY be left empty if there is at least one payment instruction provided in a query parameter, allowing for recipients wishing to avoid a standard on-chain fallback.</p>
<h3> Query Keys </h3>
<p>The following keys are defined generally and apply to any URI regardless of payment instructions:</p>
<ul>
<li>label: Label for the recipient (e.g. name of receiver)</li>
<li>message: message that describes the transaction to the user (<a href=" Examples" target="_blank">see examples below</a>)</li>
<li>pop: a URI which the Bitcoin Wallet may return to in order to provide the application which initiated the payment with proof that a payment was completed.</li>
</ul>
<p>The following keys are currently defined for payment instructions of various forms:</p>
<ul>
<li>lightning: Lightning BOLT 11 invoices</li>
<li>lno: Lightning BOLT12 offers</li>
<li>pay: <a href="/351" target="_blank">BIP 351 Private Payment addresses</a></li>
<li>sp: <a href="/352" target="_blank">BIP 352 Silent Payment addresses</a></li>
</ul>
<p>New payment instructions using bech32 or bech32m encodings SHOULD reuse their address format's Human Readable Part as the parameter key.</p>
<h4> Transfer amount </h4>
<p>If an amount is provided, it MUST be specified in decimal BTC.
All amounts MUST contain no commas and use a period (.) as the separating character to separate whole numbers and decimal fractions.
I.e. amount=50.00 or amount=50 is treated as 50 BTC, and amount=50,000.00 is invalid.</p>
<h3> Proof of Payment </h3>
<p>The URI MAY include a &quot;pop&quot; (or &quot;req-pop&quot;) parameter whose value can be used to build a URI which the wallet application can, after payment completes, &quot;open&quot; to provide proof the payment was completed or other information about the payment.</p>
<p>The value of a &quot;pop&quot; (or &quot;req-pop&quot;) parameter shall be a percent-encoded (per RFC 3986 section 2.1) URI prefix. The wallet application, if it supports providing payment information SHOULD percent-decode the provided URI once, append the query parameter key from which the payment instructions used were read, append a single =, and finally append the Payment Information to the resulting URI and open it with the default system handler for the URI. For payment instructions read from the body of the URI, &quot;onchain&quot; SHALL be used in place of the key.</p>
<p>A wallet MUST validate that the provided URI's scheme is not (case-insensitive) &quot;http&quot;, &quot;https&quot;, &quot;file&quot;, &quot;javascript&quot;, &quot;mailto&quot; or any other scheme which will open in a web browser prior to opening it.</p>
<p>If a wallet will not open the pop scheme (either because it does not support returning payment information for the selected payment method or because it uses a URI scheme which should not be opened) and the parameter was passed as a &quot;req-pop&quot; parameter, the wallet MUST NOT initiate payment.</p>
<p>For payments made using an on-chain transaction, the Payment Information shall be the full (including witness data) Bitcoin transaction as it was broadcasted to the Bitcoin network, encoded in hex.</p>
<p>For payments made using a BOLT 11 invoice (communicated via the <code>lightning</code> parameter), the Payment Information shall be the hex-encoded payment preimage.</p>
<p>Other payment schemes will define their own Payment Information format. This BIP may be updated from time to time with Payment Information formats for other payment schemes.</p>
<h2> Rationale </h2>
<h3> Payment identifiers, not person identifiers </h3>
<p>Best practices are that a unique address should be used for every transaction on-chain.
Therefore, a URI which contains an on-chain payment address MUST NOT represent an exchange of personal information, but a one-time payment instruction. URIs which represent only reusable non-address-reusing payment instructions (like Lightning BOLT12 offers or Silent Payments) MAY be reused as a wallet sees fit.</p>
<h3> Proof of Payment </h3>
<p>On many mobile operating systems (especially, or any operating system more generally), applications may &quot;open&quot; a bitcoin: URI in order to initiate a payment with the user's default wallet application. These payment-initiating applications may wish to learn about the completed payment.</p>
<p>For payments completed on-chain, this is largely addressed by having the payment-initiating application monitor the blockchain for payment completion, however for other payment schemes (e.g. lightning), no such global ledger of transactions exists. In that case, proof of payment must be provided via some other mechanism.</p>
<p>In order to avoid inadvertently revealing the sender's IP address or other information to the recipient, proof URIs must only be opened when they will simply switch to another locally-installed application (i.e. the application which initiated the payment). When clicking a URI from a website, the website should already have plenty of logic on its backend to process payment completion and a proof-of-payment callback is unnecessary.</p>
<h2> Reference Implementation </h2>
<p>Documentation: https://docs.rs/bitcoin-payment-instructions</p>
<p>Code repository: https://github.com/rust-bitcoin/bitcoin-payment-instructions</p>
<h2> Forward compatibility </h2>
<p>Query parameter keys which are prefixed with a req- are considered required.  If a client does not implement handling a query parameter which has a key prefixed with req-, it MUST consider the entire URI invalid.  Any other query parameters which are not implemented, but which are not prefixed with a req-, can be safely ignored.</p>
<p>As future new address types should be added using query parameters rather than the <code>bitcoinaddress</code> field, URIs seamlessly support various payment instructions while senders only need to support legacy instructions. This allows old senders to pay newer recipients which offer more modern payment instruction formats.</p>
<h2> Backward compatibility </h2>
<p>Compared to BIP 21, this document describes standard query parameters containing payment instructions, makes query parameters case-insensitive, allows bech32 and bech32m addresses in the <code>bitcoinaddress</code> field, and allows for URIs with an empty <code>bitcoinaddress</code> field. Use of bech32 and bech32m <code>bitcoinaddress</code> fields were long-since common practice in 2024, and the <code>lightning</code> query parameter storing BOLT 11 payment instructions became common practice in the year or three leading up to 2024. Inclusion of standard query parameters was added to provide guidance on query parameter usage going forward.</p>
<p>Additionally, this BIP describes the &quot;pop&quot; query parameter, which was unused and will be ignored by BIP 21 implementations.</p>
<p>Any existing BIP 21 implementation should automatically be fully compliant with this BIP, as the changes only describe existing practice or impact future address format inclusion, with the one possible exception of query parameters being made case-insensitive. Note, however, that treating query parameters as case-insensitive is already common practice due to the use of mostly-uppercase URIs in QR codes.</p>
<h2> Appendix </h2>
<h3> Examples </h3>
<h4> URIs </h4>
<p>Just the address:</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W
</code></pre>
<p>Address with recipient's name as label:</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?label=Luke-Jr
</code></pre>
<p>Request 20.30 BTC to &quot;Luke-Jr&quot;:</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=20.3&amp;label=Luke-Jr
</code></pre>
<p>Request 50 BTC with message:</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=50&amp;label=Luke-Jr&amp;message=Donation%20for%20project%20xyz
</code></pre>
<p>Request funds to be paid over lightning to a BOLT 11 invoice with a fallback to on-chain payments:</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?lightning=lnbc420bogusinvoice
</code></pre>
<p>Request funds to be paid over lightning to a BOLT 11 invoice with no fallback:</p>
<pre><code> bitcoin:?lightning=lnbc420bogusinvoice
</code></pre>
<p>Request funds to be paid over lightning to a BOLT 12 offer with no fallback:</p>
<pre><code> bitcoin:?lno=lno1bogusoffer
</code></pre>
<p>Request funds to be paid over lightning to a BOLT 12 offer or silent payments address with no fallback:</p>
<pre><code> bitcoin:?lno=lno1bogusoffer&amp;sp=sp1qsilentpayment
</code></pre>
<p>Request funds to be paid to a silent payments address with no fallback:</p>
<pre><code> bitcoin:?sp=sp1qsilentpayment
</code></pre>
<p>Request funds to be paid to a silent payments address with a fallback:</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?sp=sp1qsilentpayment
</code></pre>
<p>Some future version that has variables which are (currently) not understood and required and thus invalid:</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?req-somethingyoudontunderstand=50&amp;req-somethingelseyoudontget=999
</code></pre>
<p>Some future version that has variables which are (currently) not understood but not required and thus valid:</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?somethingyoudontunderstand=50&amp;somethingelseyoudontget=999
</code></pre>
<p>Multiple segwit addresses may be included for various versions of segwit, note that the human-readable part for all of them is <code>bc</code></p>
<pre><code> bitcoin:?bc=bc1qufgy354j3kmvuch987xe4s40836x3h0lg8f5n2&amp;bc=bc1p5swkugezn97763tl0yty6556856uug0q6jflljvep9m4p7339x5qzyrh4g
</code></pre>
<p>Many QR codes utilize all-uppercase URIs, which should be handled fine</p>
<pre><code> BITCOIN:BC1QUFGY354J3KMVUCH987XE4S40836X3H0LG8F5N2?BC=BC1P5SWKUGEZN97763TL0YTY6556856UUG0Q6JFLLJVEP9M4P7339X5QZYRH4G
 BITCOIN:?BC=BC1QUFGY354J3KMVUCH987XE4S40836X3H0LG8F5N2&amp;BC=BC1P5SWKUGEZN97763TL0YTY6556856UUG0Q6JFLLJVEP9M4P7339X5QZYRH4G
</code></pre>
<p>A testnet segwit addresses must be included in the <code>tb</code> parameter</p>
<pre><code> bitcoin:?tb=tb1qghfhmd4zh7ncpmxl3qzhmq566jk8ckq4gafnmg
</code></pre>
<p>Characters must be URI encoded properly.</p>
<h4> Invalid URIs </h4>
<p>Labels must not appear twice:</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?label=Luke-Jr&amp;label=Matt
</code></pre>
<p>Amounts must not appear twice:</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=42&amp;amount=10
</code></pre>
<p>Amounts must not appear twice even if they are the same:</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=42&amp;amount=42
</code></pre>
<p>Multiple proof of payment URIs must not appear, even if they are sometimes prefixed with req-:</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?pop=callback%3a&amp;req-pop=callback%3a
</code></pre>
<p>A testnet segwit addresses must be included in the <code>tb</code> parameter, not the <code>bc</code> parameter.</p>
<pre><code> bitcoin:?bc=tb1qghfhmd4zh7ncpmxl3qzhmq566jk8ckq4gafnmg
</code></pre>
<h4> Proof of Payment </h4>
<p>If the original URI is</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?pop=initiatingapp%3a
</code></pre>
<p>the wallet should perform the payment information callback by opening</p>
<pre><code> initiatingapp:onchain=$HEX_ENCODED_TRANSACTION
</code></pre>
<p>If the original URI is</p>
<pre><code> bitcoin:?lightning=lnbc420bogusinvoice&amp;pop=callbackuri%3abody%3fpop=
</code></pre>
<p>the wallet should perform the proof-of-payment callback by opening</p>
<pre><code> callbackuri:body?pop=lightning=$HEX_ENCODED_PAYMENT_PREIMAGE
</code></pre>
<p>If the original URI is</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?lightning=lnbc420bogusinvoice&amp;pop=app%3a%3f
</code></pre>
<p>and the wallet pays on-chain, it should perform the payment information callback by opening</p>
<pre><code> app:?onchain=$HEX_ENCODED_TRANSACTION
</code></pre>
<p>but if the app pays using lightning, it should perform the proof-of-payment callback by opening</p>
<pre><code> app:?lightning=$HEX_ENCODED_PAYMENT_PREIMAGE
</code></pre>
<p>If the original URI is</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?pop=https%3aiwantyouripaddress.com
</code></pre>
<p>the wallet should make a payment as it normally would but MUST NOT interact with iwantyouripaddress.com</p>
<p>If the original URI is</p>
<pre><code> bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?req-pop=https%3aevilwebsite.com
</code></pre>
<p>the wallet MUST NOT make a payment</p>

        </article>
    </div>


            <hr class="border-slate-700" />

            <div data-pagefind-ignore class="w-full flex flex-col items-center space-y-2 text-center">
                <div class="flex items-center space-x-2">
                    <p class="font-bold">Updated</p>
                    <p class="font-bold">2025-11-02</p>
                </div>
                <p>See an issue with rendering or formatting? Submit an issue on <a href="https://github.com/nickmonad/bips.dev" target="_blank">GitHub</a></p>
                <p>Do you find this site useful? Please consider <a href="https://buy.tryspeed.com/plink_live_lyek4a2yW2Sn2wfA" target="_blank">donating</a> some sats to support ongoing development.</p>
                <p><a href="/">bips.dev</a> is presented by <a href="https://nickmonad.blog" target="_blank">nickmonad</a></p>
                <p class="pt-4 text-sm">All content is owned and licensed by the respective author(s). This website makes no claim of ownership.</p>
            </div>
        </div>
    </div>
</body>
</html>
