<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="description" content="Read BIPs like a pro." />
    <meta name="keywords" content="bitcoin, bitcoin improvement proposals, bip, bips, static, share" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta property="og:title" content="BIP 371: Taproot Fields for PSBT" />
    <meta property="og:description" content="Read BIPs like a pro." />
    <meta property="og:image" content="https://bips.dev/og-bips-dev.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="BIP 371: Taproot Fields for PSBT" />
    <meta name="twitter:description" content="Read BIPs like a pro." />
    <meta name="twitter:creator" content="@nickmonad" />
    <meta name="twitter:image" content="https://bips.dev/og-bips-dev.png" />

    <title>BIP 371: Taproot Fields for PSBT</title>

    
        <link rel="stylesheet" href="/style.css" />
    

    <link rel="stylesheet" href="/pagefind/pagefind-ui.css" />
    <script src="/pagefind/pagefind-ui.js"></script>

    <script defer data-domain="bips.dev" src="/js/script.js"></script>
    <script>
        // setup plausible function for custom events
        window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }

        // setup and initialize dark mode
        // https://tailwindcss.com/docs/dark-mode
        window.setTheme = function() {
            if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark')
            } else {
                document.documentElement.classList.remove('dark')
            }
        }
        window.setTheme();

        // searching via
        // https://pagefind.app
        window.addEventListener('DOMContentLoaded', function(event) {
            new PagefindUI({
                element: "#search",
                hightlightParam: "highlight",
                showImages: false,
                showSubResults: true,
                translations: {
                    placeholder: "Search BIPs"
                },
                processTerm: function(term) {
                    plausible('Search');
                    return term;
                }
            });
        });
    </script>

    <style>
        /* variables to override on pagefind */
        /* https://pagefind.app/docs/ui-usage/#customising-the-styles */
        /* values are from tailwind: https://tailwindcss.com/docs/customizing-colors */
        :root {
            --pagefind-ui-primary: #334155;
            --pagefind-ui-text: #334155;
            --pagefind-ui-background: #ffffff;
            --pagefind-ui-border-width: 1px;
            --pagefind-ui-border-radius: 4px;
        }

        html.dark {
            --pagefind-ui-primary: #d1d5db;
            --pagefind-ui-text: #d1d5db;
            --pagefind-ui-background: #18181b;
            --pagefind-ui-border: #152028;
        }

        mark {
            background-color: #ff9900 !important;
            color: #6b7280 !important;
        }
    </style>
</head>

<body class="bg-white dark:bg-zinc-900">
    <div class="container mx-auto flex justify-center">
        <div data-pagefind-body class="min-w-full max-w-full lg:min-w-[1000px] lg:max-w-[1000px] px-6 py-10 space-y-10 text-slate-700 dark:text-gray-300">
            
    <div class="flex flex-col space-y-4 pt-4 md:pt-8">
        <div class="flex justify-between">
            <a href="/">Back to BIPs</a>
            <div class="flex">
                <svg id="toggleDark_light" class="hidden dark:flex w-6 h-6 hover:cursor-pointer" onclick="localStorage.theme = 'light'; window.setTheme()"
                        xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
                </svg>
                <svg id="toggleDark_dark" class="flex dark:hidden w-6 h-6 hover:cursor-pointer" onclick="localStorage.theme = 'dark'; window.setTheme()"
                        xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" />
                </svg>
            </div>
        </div>
        <div class="flex flex-col space-y-2">
            <div data-pagefind-weight="10" class="text-2xl font-extrabold">BIP 371: Taproot Fields for PSBT</div>
            <div class="flex justify-between">
                <div class="text-xl font-semibold">2021-06-21</div>
                <a href="https:&#x2F;&#x2F;github.com&#x2F;bitcoin&#x2F;bips&#x2F;blob&#x2F;master&#x2F;bip-0371.mediawiki" target="_blank">View on GitHub</a>
            </div>
        </div>

        <article class="max-w-none prose prose-lg prose-zinc prose-p:leading-relaxed prose-a:font-bold prose-a:underline prose-a:decoration-2 prose-a:decoration-bitcoin prose-pre:bg-zinc-200 prose-pre:text-zinc-800 dark:prose-invert dark:prose-pre:bg-zinc-600 dark:prose-pre:text-white">
            <pre><code>  BIP: 371
  Layer: Applications
  Title: Taproot Fields for PSBT
  Author: Ava Chow &lt;me@achow101.com&gt;
  Comments-Summary: No comments yet.
  Comments-URI: https:&#x2F;&#x2F;github.com&#x2F;bitcoin&#x2F;bips&#x2F;wiki&#x2F;Comments:BIP-0371
  Status: Final
  Type: Standards Track
  Created: 2021-06-21
  License: BSD-2-Clause
</code></pre>
<h2>Introduction</h2>
<h3>Abstract</h3>
<p>This document proposes additional fields for BIP 174 PSBTv0 and BIP 370 PSBTv2 that allow for
BIP 340/341/342 Taproot data to be included in a PSBT of any version. These will be fields for
signatures and scripts that are relevant to the creation of Taproot inputs.</p>
<h3>Copyright</h3>
<p>This BIP is licensed under the 2-clause BSD license.</p>
<h3>Motivation</h3>
<p>BIPs 340, 341, and 342 specify Taproot which provides a wholly new way to create and spend Bitcoin outputs.
The existing PSBT fields are unable to support Taproot due to the new signature algorithm and the method
by which scripts are embedded inside of a Taproot output. Therefore new fields must be defined to allow
PSBTs to carry the information necessary for signing Taproot inputs.</p>
<h2>Specification</h2>
<p>The new per-input types are defined as follows:</p>
<table><thead><tr><th>Name</th><th><tt><keytype></tt></th><th><tt><keydata></tt></th><th><tt><keydata></tt> Description</th><th><tt><valuedata></tt></th><th><tt><valuedata></tt> Description</th><th>Versions Requiring Inclusion</th><th>Versions Requiring Exclusion</th><th>Versions Allowing Inclusion</th></tr></thead><tbody>
<tr><td>Taproot Key Spend Signature</td><td><tt>PSBT_IN_TAP_KEY_SIG = 0x13</tt></td><td>None</td><td>No key data <sup id="cite_ref_1"><a href="#cite_ref_1">1</a></sup></td><td><tt>&lt;64 or 65 byte signature&gt;</tt></td><td>The 64 or 65 byte Schnorr signature for key path spending a Taproot output. Finalizers should remove this field after <tt>PSBT_IN_FINAL_SCRIPTWITNESS</tt> is constructed.</td><td></td><td></td><td>0, 2</td></tr>
<tr><td>Taproot Script Spend Signature</td><td><tt>PSBT_IN_TAP_SCRIPT_SIG = 0x14</tt></td><td><tt><xonlypubkey> <leafhash></tt></td><td>A 32 byte X-only public key involved in a leaf script concatenated with the 32 byte hash of the leaf it is part of.</td><td><tt>&lt;64 or 65 byte signature&gt;</tt></td><td>The 64 or 65 byte Schnorr signature for this pubkey and leaf combination. Finalizers should remove this field after <tt>PSBT_IN_FINAL_SCRIPTWITNESS</tt> is constructed.</td><td></td><td></td><td>0, 2</td></tr>
<tr><td>Taproot Leaf Script</td><td><tt>PSBT_IN_TAP_LEAF_SCRIPT = 0x15</tt></td><td><tt><bytes control block></tt></td><td>The control block for this leaf as specified in BIP 341. The control block contains the merkle tree path to this leaf.</td><td><tt><bytes script> &lt;8-bit uint leaf version&gt;</tt></td><td>The script for this leaf as would be provided in the witness stack followed by the single byte leaf version. Note that the leaves included in this field should be those that the signers of this input are expected to be able to sign for. Finalizers should remove this field after <tt>PSBT_IN_FINAL_SCRIPTWITNESS</tt> is constructed.</td><td></td><td></td><td>0, 2</td></tr>
<tr><td>Taproot Key BIP 32 Derivation Path</td><td><tt>PSBT_IN_TAP_BIP32_DERIVATION = 0x16</tt></td><td><tt>&lt;32 byte xonlypubkey&gt;</tt></td><td>A 32 byte X-only public key involved in this input. It may be the output key, the internal key, or a key present in a leaf script.</td><td><tt><compact size uint number of hashes> &lt;32 byte leaf hash&gt;* &lt;4 byte fingerprint&gt; &lt;32-bit little endian uint path element&gt;*</tt></td><td>A compact size unsigned integer representing the number of leaf hashes, followed by a list of leaf hashes, followed by the 4 byte master key fingerprint concatenated with the derivation path of the public key. The derivation path is represented as 32-bit little endian unsigned integer indexes concatenated with each other. Public keys are those needed to spend this output. The leaf hashes are of the leaves which involve this public key. The internal key does not have leaf hashes, so can be indicated with a <tt>hashes len</tt> of 0. Finalizers should remove this field after <tt>PSBT_IN_FINAL_SCRIPTWITNESS</tt> is constructed.</td><td></td><td></td><td>0, 2</td></tr>
<tr><td>Taproot Internal Key</td><td><tt>PSBT_IN_TAP_INTERNAL_KEY = 0x17</tt></td><td>None</td><td>No key data</td><td><tt>&lt;32 byte xonlypubkey&gt;</tt></td><td>The X-only pubkey used as the internal key in this output.<sup id="cite_ref_2"><a href="#cite_ref_2">2</a></sup> Finalizers should remove this field after <tt>PSBT_IN_FINAL_SCRIPTWITNESS</tt> is constructed.</td><td></td><td></td><td>0, 2</td></tr>
<tr><td>Taproot Merkle Root</td><td><tt>PSBT_IN_TAP_MERKLE_ROOT = 0x18</tt></td><td>None</td><td>No key data</td><td><tt>&lt;32-byte hash&gt;</tt></td><td>The 32 byte Merkle root hash. Finalizers should remove this field after <tt>PSBT_IN_FINAL_SCRIPTWITNESS</tt> is constructed.</td><td></td><td></td><td>0, 2</td></tr>
</tbody></table>
<p>The new per-output types are defined as follows:</p>
<table><thead><tr><th>Name</th><th><tt><keytype></tt></th><th><tt><keydata></tt></th><th><tt><keydata></tt> Description</th><th><tt><valuedata></tt></th><th><tt><valuedata></tt> Description</th><th>Versions Requiring Inclusion</th><th>Versions Requiring Exclusion</th><th>Versions Allowing Inclusion</th></tr></thead><tbody>
<tr><td>Taproot Internal Key</td><td><tt>PSBT_OUT_TAP_INTERNAL_KEY = 0x05</tt></td><td>None</td><td>No key data</td><td><tt>&lt;32 byte xonlypubkey&gt;</tt></td><td>The X-only pubkey used as the internal key in this output.</td><td></td><td></td><td>0, 2</td></tr>
<tr><td>Taproot Tree</td><td><tt>PSBT_OUT_TAP_TREE = 0x06</tt></td><td>None</td><td>No key data</td><td><tt>{&lt;8-bit uint depth&gt; &lt;8-bit uint leaf version&gt; <compact size uint scriptlen> <bytes script>}*</tt></td><td>One or more tuples representing the depth, leaf version, and script for a leaf in the Taproot tree, allowing the entire tree to be reconstructed. The tuples must be in depth first search order so that the tree is correctly reconstructed. Each tuple is an 8-bit unsigned integer representing the depth in the Taproot tree for this script, an 8-bit unsigned integer representing the leaf version, the length of the script as a compact size unsigned integer, and the script itself.</td><td></td><td></td><td>0, 2</td></tr>
<tr><td>Taproot Key BIP 32 Derivation Path</td><td><tt>PSBT_OUT_TAP_BIP32_DERIVATION = 0x07</tt></td><td><tt>&lt;32 byte xonlypubkey&gt;</tt></td><td>A 32 byte X-only public key involved in this output. It may be the output key, the internal key, or a key present in a leaf script.</td><td><tt><compact size uint number of hashes> &lt;32 byte leaf hash&gt;* &lt;4 byte fingerprint&gt; &lt;32-bit little endian uint path element&gt;*</tt></td><td>A compact size unsigned integer representing the number of leaf hashes, followed by a list of leaf hashes, followed by the 4 byte master key fingerprint concatenated with the derivation path of the public key. The derivation path is represented as 32-bit little endian unsigned integer indexes concatenated with each other. Public keys are those needed to spend this output. The leaf hashes are of the leaves which involve this public key. The internal key does not have leaf hashes, so can be indicated with a <tt>hashes len</tt> of 0. Finalizers should remove this field after <tt>PSBT_IN_FINAL_SCRIPTWITNESS</tt> is constructed.</td><td></td><td></td><td>0, 2</td></tr>
</tbody></table>
<h3>UTXO Types</h3>
<p>BIP 174 recommends using <tt>PSBT_IN_NON_WITNESS_UTXO</tt> for all inputs because of potential attacks involving
an updater lying about the amounts in an output. Because a Taproot signature will commit to all of the amounts
and output scripts spent by the inputs of the transaction, such attacks are prevented as any such lying would
result in an invalid signature. Thus Taproot inputs can use just <tt>PSBT_IN_WITNESS_UTXO</tt>.</p>
<h2>Compatibility</h2>
<p>These are simply new fields added to the existing PSBT format. Because PSBT is designed to be extensible, old
software will ignore the new fields.</p>
<h2>Test Vectors</h2>
<p>The following are invalid PSBTs:</p>
<ul>
<li>Case: PSBT With <tt>PSBT_IN_TAP_INTERNAL_KEY</tt> key that is too long (incorrectly serialized as compressed DER)
<ul>
<li>Bytes in Hex: <pre>70736274ff010071020000000127744ababf3027fe0d6cf23a96eee2efb188ef52301954585883e69b6624b2420000000000ffffffff02787c01000000000016001483a7e34bd99ff03a4962ef8a1a101bb295461ece606b042a010000001600147ac369df1b20e033d6116623957b0ac49f3c52e8000000000001012b00f2052a010000002251205a2c2cf5b52cf31f83ad2e8da63ff03183ecd8f609c7510ae8a48e03910a075701172102fe349064c98d6e2a853fa3c9b12bd8b304a19c195c60efa7ee2393046d3fa232000000</li>
</ul>
</li>
</ul>
<pre><code>** Base64 String: &lt;pre&gt;cHNidP8BAHECAAAAASd0Srq&#x2F;MCf+DWzyOpbu4u+xiO9SMBlUWFiD5ptmJLJCAAAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;Anh8AQAAAAAAFgAUg6fjS9mf8DpJYu+KGhAbspVGHs5gawQqAQAAABYAFHrDad8bIOAz1hFmI5V7CsSfPFLoAAAAAAABASsA8gUqAQAAACJRIFosLPW1LPMfg60ujaY&#x2F;8DGD7Nj2CcdRCuikjgORCgdXARchAv40kGTJjW4qhT+jybEr2LMEoZwZXGDvp+4jkwRtP6IyAAAA&lt;&#x2F;pre&gt;

* Case: PSBT With &lt;tt&gt;PSBT_KEY_PATH_SIG&lt;&#x2F;tt&gt; signature that is too short
** Bytes in Hex: &lt;pre&gt;&lt;70736274ff010071020000000127744ababf3027fe0d6cf23a96eee2efb188ef52301954585883e69b6624b2420000000000ffffffff02787c01000000000016001483a7e34bd99ff03a4962ef8a1a101bb295461ece606b042a010000001600147ac369df1b20e033d6116623957b0ac49f3c52e8000000000001012b00f2052a010000002251205a2c2cf5b52cf31f83ad2e8da63ff03183ecd8f609c7510ae8a48e03910a075701133f173bb3d36c074afb716fec6307a069a2e450b995f3c82785945ab8df0e24260dcd703b0cbf34de399184a9481ac2b3586db6601f026a77f7e4938481bc3475000000&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAHECAAAAASd0Srq&#x2F;MCf+DWzyOpbu4u+xiO9SMBlUWFiD5ptmJLJCAAAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;Anh8AQAAAAAAFgAUg6fjS9mf8DpJYu+KGhAbspVGHs5gawQqAQAAABYAFHrDad8bIOAz1hFmI5V7CsSfPFLoAAAAAAABASsA8gUqAQAAACJRIFosLPW1LPMfg60ujaY&#x2F;8DGD7Nj2CcdRCuikjgORCgdXARM&#x2F;Fzuz02wHSvtxb+xjB6BpouRQuZXzyCeFlFq43w4kJg3NcDsMvzTeOZGEqUgawrNYbbZgHwJqd&#x2F;fkk4SBvDR1AAAA&lt;&#x2F;pre&gt;

* Case: PSBT With &lt;tt&gt;PSBT_KEY_PATH_SIG&lt;&#x2F;tt&gt; signature that is too long
** Bytes in Hex: &lt;pre&gt;&lt;70736274ff010071020000000127744ababf3027fe0d6cf23a96eee2efb188ef52301954585883e69b6624b2420000000000ffffffff02787c01000000000016001483a7e34bd99ff03a4962ef8a1a101bb295461ece606b042a010000001600147ac369df1b20e033d6116623957b0ac49f3c52e8000000000001012b00f2052a010000002251205a2c2cf5b52cf31f83ad2e8da63ff03183ecd8f609c7510ae8a48e03910a0757011342173bb3d36c074afb716fec6307a069a2e450b995f3c82785945ab8df0e24260dcd703b0cbf34de399184a9481ac2b3586db6601f026a77f7e4938481bc34751701aa000000&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAHECAAAAASd0Srq&#x2F;MCf+DWzyOpbu4u+xiO9SMBlUWFiD5ptmJLJCAAAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;Anh8AQAAAAAAFgAUg6fjS9mf8DpJYu+KGhAbspVGHs5gawQqAQAAABYAFHrDad8bIOAz1hFmI5V7CsSfPFLoAAAAAAABASsA8gUqAQAAACJRIFosLPW1LPMfg60ujaY&#x2F;8DGD7Nj2CcdRCuikjgORCgdXARNCFzuz02wHSvtxb+xjB6BpouRQuZXzyCeFlFq43w4kJg3NcDsMvzTeOZGEqUgawrNYbbZgHwJqd&#x2F;fkk4SBvDR1FwGqAAAA&lt;&#x2F;pre&gt;

* Case: PSBT With &lt;tt&gt;PSBT_IN_TAP_BIP32_DERIVATION&lt;&#x2F;tt&gt; key that is too long (incorrectly serialized as compressed DER)
** Bytes in Hex: &lt;pre&gt;&lt;70736274ff010071020000000127744ababf3027fe0d6cf23a96eee2efb188ef52301954585883e69b6624b2420000000000ffffffff02787c01000000000016001483a7e34bd99ff03a4962ef8a1a101bb295461ece606b042a010000001600147ac369df1b20e033d6116623957b0ac49f3c52e8000000000001012b00f2052a010000002251205a2c2cf5b52cf31f83ad2e8da63ff03183ecd8f609c7510ae8a48e03910a0757221602fe349064c98d6e2a853fa3c9b12bd8b304a19c195c60efa7ee2393046d3fa2321900772b2da75600008001000080000000800100000000000000000000&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAHECAAAAASd0Srq&#x2F;MCf+DWzyOpbu4u+xiO9SMBlUWFiD5ptmJLJCAAAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;Anh8AQAAAAAAFgAUg6fjS9mf8DpJYu+KGhAbspVGHs5gawQqAQAAABYAFHrDad8bIOAz1hFmI5V7CsSfPFLoAAAAAAABASsA8gUqAQAAACJRIFosLPW1LPMfg60ujaY&#x2F;8DGD7Nj2CcdRCuikjgORCgdXIhYC&#x2F;jSQZMmNbiqFP6PJsSvYswShnBlcYO+n7iOTBG0&#x2F;ojIZAHcrLadWAACAAQAAgAAAAIABAAAAAAAAAAAAAA==&lt;&#x2F;pre&gt;

* Case: PSBT With &lt;tt&gt;PSBT_OUT_TAP_INTERNAL_KEY&lt;&#x2F;tt&gt; key that is too long (incorrectly serialized as compressed DER)
** Bytes in Hex: &lt;pre&gt;70736274ff01007d020000000127744ababf3027fe0d6cf23a96eee2efb188ef52301954585883e69b6624b2420000000000ffffffff02887b0100000000001600142382871c7e8421a00093f754d91281e675874b9f606b042a010000002251205a2c2cf5b52cf31f83ad2e8da63ff03183ecd8f609c7510ae8a48e03910a0757000000000001012b00f2052a010000002251205a2c2cf5b52cf31f83ad2e8da63ff03183ecd8f609c7510ae8a48e03910a0757000001052102fe349064c98d6e2a853fa3c9b12bd8b304a19c195c60efa7ee2393046d3fa23200&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAH0CAAAAASd0Srq&#x2F;MCf+DWzyOpbu4u+xiO9SMBlUWFiD5ptmJLJCAAAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;Aoh7AQAAAAAAFgAUI4KHHH6EIaAAk&#x2F;dU2RKB5nWHS59gawQqAQAAACJRIFosLPW1LPMfg60ujaY&#x2F;8DGD7Nj2CcdRCuikjgORCgdXAAAAAAABASsA8gUqAQAAACJRIFosLPW1LPMfg60ujaY&#x2F;8DGD7Nj2CcdRCuikjgORCgdXAAABBSEC&#x2F;jSQZMmNbiqFP6PJsSvYswShnBlcYO+n7iOTBG0&#x2F;ojIA&lt;&#x2F;pre&gt;

* Case: PSBT With &lt;tt&gt;PSBT_OUT_TAP_BIP32_DERIVATION&lt;&#x2F;tt&gt; key that is too long (incorrectly serialized as compressed DER)
** Bytes in Hex: &lt;pre&gt;70736274ff01007d020000000127744ababf3027fe0d6cf23a96eee2efb188ef52301954585883e69b6624b2420000000000ffffffff02887b0100000000001600142382871c7e8421a00093f754d91281e675874b9f606b042a010000002251205a2c2cf5b52cf31f83ad2e8da63ff03183ecd8f609c7510ae8a48e03910a0757000000000001012b00f2052a010000002251205a2c2cf5b52cf31f83ad2e8da63ff03183ecd8f609c7510ae8a48e03910a07570000220702fe349064c98d6e2a853fa3c9b12bd8b304a19c195c60efa7ee2393046d3fa2321900772b2da7560000800100008000000080010000000000000000&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAH0CAAAAASd0Srq&#x2F;MCf+DWzyOpbu4u+xiO9SMBlUWFiD5ptmJLJCAAAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;Aoh7AQAAAAAAFgAUI4KHHH6EIaAAk&#x2F;dU2RKB5nWHS59gawQqAQAAACJRIFosLPW1LPMfg60ujaY&#x2F;8DGD7Nj2CcdRCuikjgORCgdXAAAAAAABASsA8gUqAQAAACJRIFosLPW1LPMfg60ujaY&#x2F;8DGD7Nj2CcdRCuikjgORCgdXAAAiBwL+NJBkyY1uKoU&#x2F;o8mxK9izBKGcGVxg76fuI5MEbT+iMhkAdystp1YAAIABAACAAAAAgAEAAAAAAAAAAA==&lt;&#x2F;pre&gt;

* Case: PSBT With &lt;tt&gt;PSBT_IN_TAP_SCRIPT_SIG&lt;&#x2F;tt&gt; key that is too long (incorrectly serialized as compressed DER)
** Bytes in Hex: &lt;pre&gt;70736274ff01005e02000000019bd48765230bf9a72e662001f972556e54f0c6f97feb56bcb5600d817f6995260100000000ffffffff0148e6052a01000000225120030da4fce4f7db28c2cb2951631e003713856597fe963882cb500e68112cca63000000000001012b00f2052a01000000225120c2247efbfd92ac47f6f40b8d42d169175a19fa9fa10e4a25d7f35eb4dd85b6924214022cb13ac68248de806aa6a3659cf3c03eb6821d09c8114a4e868febde865bb6d2cd970e15f53fc0c82f950fd560ffa919b76172be017368a89913af074f400b094089756aa3739ccc689ec0fcf3a360be32cc0b59b16e93a1e8bb4605726b2ca7a3ff706c4176649632b2cc68e1f912b8a578e3719ce7710885c7a966f49bcd43cb0000&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAF4CAAAAAZvUh2UjC&#x2F;mnLmYgAflyVW5U8Mb5f+tWvLVgDYF&#x2F;aZUmAQAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;AUjmBSoBAAAAIlEgAw2k&#x2F;OT32yjCyylRYx4ANxOFZZf+ljiCy1AOaBEsymMAAAAAAAEBKwDyBSoBAAAAIlEgwiR++&#x2F;2SrEf29AuNQtFpF1oZ+p+hDkol1&#x2F;NetN2FtpJCFAIssTrGgkjegGqmo2Wc88A+toIdCcgRSk6Gj+vehlu20s2XDhX1P8DIL5UP1WD&#x2F;qRm3YXK+AXNoqJkTrwdPQAsJQIl1aqNznMxonsD886NgvjLMC1mxbpOh6LtGBXJrLKej&#x2F;3BsQXZkljKyzGjh+RK4pXjjcZzncQiFx6lm9JvNQ8sAAA==&lt;&#x2F;pre&gt;

* Case: PSBT With &lt;tt&gt;PSBT_IN_TAP_SCRIPT_SIG&lt;&#x2F;tt&gt; signature that is too long
** Bytes in Hex: &lt;pre&gt;70736274ff01005e02000000019bd48765230bf9a72e662001f972556e54f0c6f97feb56bcb5600d817f6995260100000000ffffffff0148e6052a01000000225120030da4fce4f7db28c2cb2951631e003713856597fe963882cb500e68112cca63000000000001012b00f2052a01000000225120c2247efbfd92ac47f6f40b8d42d169175a19fa9fa10e4a25d7f35eb4dd85b69241142cb13ac68248de806aa6a3659cf3c03eb6821d09c8114a4e868febde865bb6d2cd970e15f53fc0c82f950fd560ffa919b76172be017368a89913af074f400b094289756aa3739ccc689ec0fcf3a360be32cc0b59b16e93a1e8bb4605726b2ca7a3ff706c4176649632b2cc68e1f912b8a578e3719ce7710885c7a966f49bcd43cb01010000&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAF4CAAAAAZvUh2UjC&#x2F;mnLmYgAflyVW5U8Mb5f+tWvLVgDYF&#x2F;aZUmAQAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;AUjmBSoBAAAAIlEgAw2k&#x2F;OT32yjCyylRYx4ANxOFZZf+ljiCy1AOaBEsymMAAAAAAAEBKwDyBSoBAAAAIlEgwiR++&#x2F;2SrEf29AuNQtFpF1oZ+p+hDkol1&#x2F;NetN2FtpJBFCyxOsaCSN6AaqajZZzzwD62gh0JyBFKToaP696GW7bSzZcOFfU&#x2F;wMgvlQ&#x2F;VYP+pGbdhcr4Bc2iomROvB09ACwlCiXVqo3OczGiewPzzo2C+MswLWbFuk6Hou0YFcmssp6P&#x2F;cGxBdmSWMrLMaOH5ErileONxnOdxCIXHqWb0m81DywEBAAA=&lt;&#x2F;pre&gt;

* Case: PSBT With &lt;tt&gt;PSBT_IN_TAP_SCRIPT_SIG&lt;&#x2F;tt&gt; signature that is too short
** Bytes in Hex: &lt;pre&gt;70736274ff01005e02000000019bd48765230bf9a72e662001f972556e54f0c6f97feb56bcb5600d817f6995260100000000ffffffff0148e6052a01000000225120030da4fce4f7db28c2cb2951631e003713856597fe963882cb500e68112cca63000000000001012b00f2052a01000000225120c2247efbfd92ac47f6f40b8d42d169175a19fa9fa10e4a25d7f35eb4dd85b69241142cb13ac68248de806aa6a3659cf3c03eb6821d09c8114a4e868febde865bb6d2cd970e15f53fc0c82f950fd560ffa919b76172be017368a89913af074f400b093f89756aa3739ccc689ec0fcf3a360be32cc0b59b16e93a1e8bb4605726b2ca7a3ff706c4176649632b2cc68e1f912b8a578e3719ce7710885c7a966f49bcd430000&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAF4CAAAAAZvUh2UjC&#x2F;mnLmYgAflyVW5U8Mb5f+tWvLVgDYF&#x2F;aZUmAQAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;AUjmBSoBAAAAIlEgAw2k&#x2F;OT32yjCyylRYx4ANxOFZZf+ljiCy1AOaBEsymMAAAAAAAEBKwDyBSoBAAAAIlEgwiR++&#x2F;2SrEf29AuNQtFpF1oZ+p+hDkol1&#x2F;NetN2FtpJBFCyxOsaCSN6AaqajZZzzwD62gh0JyBFKToaP696GW7bSzZcOFfU&#x2F;wMgvlQ&#x2F;VYP+pGbdhcr4Bc2iomROvB09ACwk&#x2F;iXVqo3OczGiewPzzo2C+MswLWbFuk6Hou0YFcmssp6P&#x2F;cGxBdmSWMrLMaOH5ErileONxnOdxCIXHqWb0m81DAAA=&lt;&#x2F;pre&gt;

* Case: PSBT With &lt;tt&gt;PSBT_IN_TAP_LEAF_SCRIPT&lt;&#x2F;tt&gt; Control block that is too long
** Bytes in Hex: &lt;pre&gt;70736274ff01005e02000000019bd48765230bf9a72e662001f972556e54f0c6f97feb56bcb5600d817f6995260100000000ffffffff0148e6052a01000000225120030da4fce4f7db28c2cb2951631e003713856597fe963882cb500e68112cca63000000000001012b00f2052a01000000225120c2247efbfd92ac47f6f40b8d42d169175a19fa9fa10e4a25d7f35eb4dd85b6926315c150929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac06f7d62059e9497a1a4a267569d9876da60101aff38e3529b9b939ce7f91ae970115f2e490af7cc45c4f78511f36057ce5c5a5c56325a29fb44dfc203f356e1f80023202cb13ac68248de806aa6a3659cf3c03eb6821d09c8114a4e868febde865bb6d2acc00000&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAF4CAAAAAZvUh2UjC&#x2F;mnLmYgAflyVW5U8Mb5f+tWvLVgDYF&#x2F;aZUmAQAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;AUjmBSoBAAAAIlEgAw2k&#x2F;OT32yjCyylRYx4ANxOFZZf+ljiCy1AOaBEsymMAAAAAAAEBKwDyBSoBAAAAIlEgwiR++&#x2F;2SrEf29AuNQtFpF1oZ+p+hDkol1&#x2F;NetN2FtpJjFcFQkpt0waBJVLeLS2A16XpeB4paDyjsltVHv+6azoA6wG99YgWelJehpKJnVp2YdtpgEBr&#x2F;OONSm5uTnOf5GulwEV8uSQr3zEXE94UR82BXzlxaXFYyWin7RN&#x2F;CA&#x2F;NW4fgAIyAssTrGgkjegGqmo2Wc88A+toIdCcgRSk6Gj+vehlu20qzAAAA=&lt;&#x2F;pre&gt;

* Case: PSBT With &lt;tt&gt;PSBT_IN_TAP_LEAF_SCRIPT&lt;&#x2F;tt&gt; Control block that is too short
** Bytes in Hex: &lt;pre&gt;70736274ff01005e02000000019bd48765230bf9a72e662001f972556e54f0c6f97feb56bcb5600d817f6995260100000000ffffffff0148e6052a01000000225120030da4fce4f7db28c2cb2951631e003713856597fe963882cb500e68112cca63000000000001012b00f2052a01000000225120c2247efbfd92ac47f6f40b8d42d169175a19fa9fa10e4a25d7f35eb4dd85b6926115c150929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac06f7d62059e9497a1a4a267569d9876da60101aff38e3529b9b939ce7f91ae970115f2e490af7cc45c4f78511f36057ce5c5a5c56325a29fb44dfc203f356e123202cb13ac68248de806aa6a3659cf3c03eb6821d09c8114a4e868febde865bb6d2acc00000&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAF4CAAAAAZvUh2UjC&#x2F;mnLmYgAflyVW5U8Mb5f+tWvLVgDYF&#x2F;aZUmAQAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;AUjmBSoBAAAAIlEgAw2k&#x2F;OT32yjCyylRYx4ANxOFZZf+ljiCy1AOaBEsymMAAAAAAAEBKwDyBSoBAAAAIlEgwiR++&#x2F;2SrEf29AuNQtFpF1oZ+p+hDkol1&#x2F;NetN2FtpJhFcFQkpt0waBJVLeLS2A16XpeB4paDyjsltVHv+6azoA6wG99YgWelJehpKJnVp2YdtpgEBr&#x2F;OONSm5uTnOf5GulwEV8uSQr3zEXE94UR82BXzlxaXFYyWin7RN&#x2F;CA&#x2F;NW4SMgLLE6xoJI3oBqpqNlnPPAPraCHQnIEUpOho&#x2F;r3oZbttKswAAA&lt;&#x2F;pre&gt;

The following are valid PSBTs:

* Case: PSBT with one P2TR key only input with internal key and its derivation path
** Bytes in Hex: &lt;pre&gt;70736274ff010052020000000127744ababf3027fe0d6cf23a96eee2efb188ef52301954585883e69b6624b2420000000000ffffffff0148e6052a01000000160014768e1eeb4cf420866033f80aceff0f9720744969000000000001012b00f2052a010000002251205a2c2cf5b52cf31f83ad2e8da63ff03183ecd8f609c7510ae8a48e03910a07572116fe349064c98d6e2a853fa3c9b12bd8b304a19c195c60efa7ee2393046d3fa2321900772b2da75600008001000080000000800100000000000000011720fe349064c98d6e2a853fa3c9b12bd8b304a19c195c60efa7ee2393046d3fa232002202036b772a6db74d8753c98a827958de6c78ab3312109f37d3e0304484242ece73d818772b2da7540000800100008000000080000000000000000000&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAFICAAAAASd0Srq&#x2F;MCf+DWzyOpbu4u+xiO9SMBlUWFiD5ptmJLJCAAAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;AUjmBSoBAAAAFgAUdo4e60z0IIZgM&#x2F;gKzv8PlyB0SWkAAAAAAAEBKwDyBSoBAAAAIlEgWiws9bUs8x+DrS6Npj&#x2F;wMYPs2PYJx1EK6KSOA5EKB1chFv40kGTJjW4qhT+jybEr2LMEoZwZXGDvp+4jkwRtP6IyGQB3Ky2nVgAAgAEAAIAAAACAAQAAAAAAAAABFyD+NJBkyY1uKoU&#x2F;o8mxK9izBKGcGVxg76fuI5MEbT+iMgAiAgNrdyptt02HU8mKgnlY3mx4qzMSEJ830+AwRIQkLs5z2Bh3Ky2nVAAAgAEAAIAAAACAAAAAAAAAAAAA&lt;&#x2F;pre&gt;

* Case: PSBT with one P2TR key only input with internal key, its derivation path, and signature
** Bytes in Hex: &lt;pre&gt;70736274ff010052020000000127744ababf3027fe0d6cf23a96eee2efb188ef52301954585883e69b6624b2420000000000ffffffff0148e6052a01000000160014768e1eeb4cf420866033f80aceff0f9720744969000000000001012b00f2052a010000002251205a2c2cf5b52cf31f83ad2e8da63ff03183ecd8f609c7510ae8a48e03910a0757011340bb53ec917bad9d906af1ba87181c48b86ace5aae2b53605a725ca74625631476fc6f5baedaf4f2ee0f477f36f58f3970d5b8273b7e497b97af2e3f125c97af342116fe349064c98d6e2a853fa3c9b12bd8b304a19c195c60efa7ee2393046d3fa2321900772b2da75600008001000080000000800100000000000000011720fe349064c98d6e2a853fa3c9b12bd8b304a19c195c60efa7ee2393046d3fa232002202036b772a6db74d8753c98a827958de6c78ab3312109f37d3e0304484242ece73d818772b2da7540000800100008000000080000000000000000000&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAFICAAAAASd0Srq&#x2F;MCf+DWzyOpbu4u+xiO9SMBlUWFiD5ptmJLJCAAAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;AUjmBSoBAAAAFgAUdo4e60z0IIZgM&#x2F;gKzv8PlyB0SWkAAAAAAAEBKwDyBSoBAAAAIlEgWiws9bUs8x+DrS6Npj&#x2F;wMYPs2PYJx1EK6KSOA5EKB1cBE0C7U+yRe62dkGrxuocYHEi4as5aritTYFpyXKdGJWMUdvxvW67a9PLuD0d&#x2F;NvWPOXDVuCc7fkl7l68uPxJcl680IRb+NJBkyY1uKoU&#x2F;o8mxK9izBKGcGVxg76fuI5MEbT+iMhkAdystp1YAAIABAACAAAAAgAEAAAAAAAAAARcg&#x2F;jSQZMmNbiqFP6PJsSvYswShnBlcYO+n7iOTBG0&#x2F;ojIAIgIDa3cqbbdNh1PJioJ5WN5seKszEhCfN9PgMESEJC7Oc9gYdystp1QAAIABAACAAAAAgAAAAAAAAAAAAA==&lt;&#x2F;pre&gt;

* Case: PSBT with one P2TR key only output with internal key and its derivation path
** Bytes in Hex: &lt;pre&gt;70736274ff01005e020000000127744ababf3027fe0d6cf23a96eee2efb188ef52301954585883e69b6624b2420000000000ffffffff0148e6052a0100000022512083698e458c6664e1595d75da2597de1e22ee97d798e706c4c0a4b5a9823cd743000000000001012b00f2052a010000002251205a2c2cf5b52cf31f83ad2e8da63ff03183ecd8f609c7510ae8a48e03910a07572116fe349064c98d6e2a853fa3c9b12bd8b304a19c195c60efa7ee2393046d3fa2321900772b2da75600008001000080000000800100000000000000011720fe349064c98d6e2a853fa3c9b12bd8b304a19c195c60efa7ee2393046d3fa232000105201124da7aec92ccd06c954562647f437b138b95721a84be2bf2276bbddab3e67121071124da7aec92ccd06c954562647f437b138b95721a84be2bf2276bbddab3e6711900772b2da7560000800100008000000080000000000500000000&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAF4CAAAAASd0Srq&#x2F;MCf+DWzyOpbu4u+xiO9SMBlUWFiD5ptmJLJCAAAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;AUjmBSoBAAAAIlEgg2mORYxmZOFZXXXaJZfeHiLul9eY5wbEwKS1qYI810MAAAAAAAEBKwDyBSoBAAAAIlEgWiws9bUs8x+DrS6Npj&#x2F;wMYPs2PYJx1EK6KSOA5EKB1chFv40kGTJjW4qhT+jybEr2LMEoZwZXGDvp+4jkwRtP6IyGQB3Ky2nVgAAgAEAAIAAAACAAQAAAAAAAAABFyD+NJBkyY1uKoU&#x2F;o8mxK9izBKGcGVxg76fuI5MEbT+iMgABBSARJNp67JLM0GyVRWJkf0N7E4uVchqEvivyJ2u92rPmcSEHESTaeuySzNBslUViZH9DexOLlXIahL4r8idrvdqz5nEZAHcrLadWAACAAQAAgAAAAIAAAAAABQAAAAA=&lt;&#x2F;pre&gt;

* Case: PSBT with one P2TR script path only input with dummy internal key, scripts, derivation paths for keys in the scripts, and merkle root
** Bytes in Hex: &lt;pre&gt;70736274ff01005e02000000019bd48765230bf9a72e662001f972556e54f0c6f97feb56bcb5600d817f6995260100000000ffffffff0148e6052a0100000022512083698e458c6664e1595d75da2597de1e22ee97d798e706c4c0a4b5a9823cd743000000000001012b00f2052a01000000225120c2247efbfd92ac47f6f40b8d42d169175a19fa9fa10e4a25d7f35eb4dd85b6926215c150929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac06f7d62059e9497a1a4a267569d9876da60101aff38e3529b9b939ce7f91ae970115f2e490af7cc45c4f78511f36057ce5c5a5c56325a29fb44dfc203f356e1f823202cb13ac68248de806aa6a3659cf3c03eb6821d09c8114a4e868febde865bb6d2acc04215c150929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac097c6e6fea5ff714ff5724499990810e406e98aa10f5bf7e5f6784bc1d0a9a6ce23204320b0bf16f011b53ea7be615924aa7f27e5d29ad20ea1155d848676c3bad1b2acc06215c150929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0cd970e15f53fc0c82f950fd560ffa919b76172be017368a89913af074f400b09115f2e490af7cc45c4f78511f36057ce5c5a5c56325a29fb44dfc203f356e1f82320fa0f7a3cef3b1d0c0a6ce7d26e17ada0b2e5c92d19efad48b41859cb8a451ca9acc021162cb13ac68248de806aa6a3659cf3c03eb6821d09c8114a4e868febde865bb6d23901cd970e15f53fc0c82f950fd560ffa919b76172be017368a89913af074f400b09772b2da7560000800100008002000080000000000000000021164320b0bf16f011b53ea7be615924aa7f27e5d29ad20ea1155d848676c3bad1b23901115f2e490af7cc45c4f78511f36057ce5c5a5c56325a29fb44dfc203f356e1f8772b2da75600008001000080010000800000000000000000211650929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac005007c461e5d2116fa0f7a3cef3b1d0c0a6ce7d26e17ada0b2e5c92d19efad48b41859cb8a451ca939016f7d62059e9497a1a4a267569d9876da60101aff38e3529b9b939ce7f91ae970772b2da7560000800100008003000080000000000000000001172050929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0011820f0362e2f75a6f420a5bde3eb221d96ae6720cf25f81890c95b1d775acb515e65000105201124da7aec92ccd06c954562647f437b138b95721a84be2bf2276bbddab3e67121071124da7aec92ccd06c954562647f437b138b95721a84be2bf2276bbddab3e6711900772b2da7560000800100008000000080000000000500000000&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAF4CAAAAAZvUh2UjC&#x2F;mnLmYgAflyVW5U8Mb5f+tWvLVgDYF&#x2F;aZUmAQAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;AUjmBSoBAAAAIlEgg2mORYxmZOFZXXXaJZfeHiLul9eY5wbEwKS1qYI810MAAAAAAAEBKwDyBSoBAAAAIlEgwiR++&#x2F;2SrEf29AuNQtFpF1oZ+p+hDkol1&#x2F;NetN2FtpJiFcFQkpt0waBJVLeLS2A16XpeB4paDyjsltVHv+6azoA6wG99YgWelJehpKJnVp2YdtpgEBr&#x2F;OONSm5uTnOf5GulwEV8uSQr3zEXE94UR82BXzlxaXFYyWin7RN&#x2F;CA&#x2F;NW4fgjICyxOsaCSN6AaqajZZzzwD62gh0JyBFKToaP696GW7bSrMBCFcFQkpt0waBJVLeLS2A16XpeB4paDyjsltVHv+6azoA6wJfG5v6l&#x2F;3FP9XJEmZkIEOQG6YqhD1v35fZ4S8HQqabOIyBDILC&#x2F;FvARtT6nvmFZJKp&#x2F;J+XSmtIOoRVdhIZ2w7rRsqzAYhXBUJKbdMGgSVS3i0tgNel6XgeKWg8o7JbVR7&#x2F;ums6AOsDNlw4V9T&#x2F;AyC+VD9Vg&#x2F;6kZt2FyvgFzaKiZE68HT0ALCRFfLkkK98xFxPeFEfNgV85cWlxWMlop+0TfwgPzVuH4IyD6D3o87zsdDAps59JuF62gsuXJLRnvrUi0GFnLikUcqazAIRYssTrGgkjegGqmo2Wc88A+toIdCcgRSk6Gj+vehlu20jkBzZcOFfU&#x2F;wMgvlQ&#x2F;VYP+pGbdhcr4Bc2iomROvB09ACwl3Ky2nVgAAgAEAAIACAACAAAAAAAAAAAAhFkMgsL8W8BG1Pqe+YVkkqn8n5dKa0g6hFV2EhnbDutGyOQERXy5JCvfMRcT3hRHzYFfOXFpcVjJaKftE38ID81bh+HcrLadWAACAAQAAgAEAAIAAAAAAAAAAACEWUJKbdMGgSVS3i0tgNel6XgeKWg8o7JbVR7&#x2F;ums6AOsAFAHxGHl0hFvoPejzvOx0MCmzn0m4XraCy5cktGe+tSLQYWcuKRRypOQFvfWIFnpSXoaSiZ1admHbaYBAa&#x2F;zjjUpubk5zn+RrpcHcrLadWAACAAQAAgAMAAIAAAAAAAAAAAAEXIFCSm3TBoElUt4tLYDXpel4HiloPKOyW1Ue&#x2F;7prOgDrAARgg8DYuL3Wm9CClvePrIh2WrmcgzyX4GJDJWx13WstRXmUAAQUgESTaeuySzNBslUViZH9DexOLlXIahL4r8idrvdqz5nEhBxEk2nrskszQbJVFYmR&#x2F;Q3sTi5VyGoS+K&#x2F;Ina73as+ZxGQB3Ky2nVgAAgAEAAIAAAACAAAAAAAUAAAAA&lt;&#x2F;pre&gt;

* Case: PSBT with one P2TR script path only output with dummy internal key, taproot tree, and script key derivation paths
** Bytes in Hex: &lt;pre&gt;70736274ff01005e020000000127744ababf3027fe0d6cf23a96eee2efb188ef52301954585883e69b6624b2420000000000ffffffff0148e6052a010000002251200a8cbdc86de1ce1c0f9caeb22d6df7ced3683fe423e05d1e402a879341d6f6f5000000000001012b00f2052a010000002251205a2c2cf5b52cf31f83ad2e8da63ff03183ecd8f609c7510ae8a48e03910a07572116fe349064c98d6e2a853fa3c9b12bd8b304a19c195c60efa7ee2393046d3fa2321900772b2da75600008001000080000000800100000000000000011720fe349064c98d6e2a853fa3c9b12bd8b304a19c195c60efa7ee2393046d3fa2320001052050929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac001066f02c02220736e572900fe1252589a2143c8f3c79f71a0412d2353af755e9701c782694a02ac02c02220631c5f3b5832b8fbdebfb19704ceeb323c21f40f7a24f43d68ef0cc26b125969ac01c0222044faa49a0338de488c8dfffecdfb6f329f380bd566ef20c8df6d813eab1c4273ac210744faa49a0338de488c8dfffecdfb6f329f380bd566ef20c8df6d813eab1c42733901f06b798b92a10ed9a9d0bbfd3af173a53b1617da3a4159ca008216cd856b2e0e772b2da75600008001000080010000800000000003000000210750929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac005007c461e5d2107631c5f3b5832b8fbdebfb19704ceeb323c21f40f7a24f43d68ef0cc26b125969390118ace409889785e0ea70ceebb8e1ca892a7a78eaede0f2e296cf435961a8f4ca772b2da756000080010000800200008000000000030000002107736e572900fe1252589a2143c8f3c79f71a0412d2353af755e9701c782694a02390129a5b4915090162d759afd3fe0f93fa3326056d0b4088cb933cae7826cb8d82c772b2da7560000800100008003000080000000000300000000&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAF4CAAAAASd0Srq&#x2F;MCf+DWzyOpbu4u+xiO9SMBlUWFiD5ptmJLJCAAAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;AUjmBSoBAAAAIlEgCoy9yG3hzhwPnK6yLW33ztNoP+Qj4F0eQCqHk0HW9vUAAAAAAAEBKwDyBSoBAAAAIlEgWiws9bUs8x+DrS6Npj&#x2F;wMYPs2PYJx1EK6KSOA5EKB1chFv40kGTJjW4qhT+jybEr2LMEoZwZXGDvp+4jkwRtP6IyGQB3Ky2nVgAAgAEAAIAAAACAAQAAAAAAAAABFyD+NJBkyY1uKoU&#x2F;o8mxK9izBKGcGVxg76fuI5MEbT+iMgABBSBQkpt0waBJVLeLS2A16XpeB4paDyjsltVHv+6azoA6wAEGbwLAIiBzblcpAP4SUliaIUPI88efcaBBLSNTr3VelwHHgmlKAqwCwCIgYxxfO1gyuPvev7GXBM7rMjwh9A96JPQ9aO8MwmsSWWmsAcAiIET6pJoDON5IjI3&#x2F;&#x2F;s37bzKfOAvVZu8gyN9tgT6rHEJzrCEHRPqkmgM43kiMjf&#x2F;+zftvMp84C9Vm7yDI322BPqscQnM5AfBreYuSoQ7ZqdC7&#x2F;Trxc6U7FhfaOkFZygCCFs2Fay4Odystp1YAAIABAACAAQAAgAAAAAADAAAAIQdQkpt0waBJVLeLS2A16XpeB4paDyjsltVHv+6azoA6wAUAfEYeXSEHYxxfO1gyuPvev7GXBM7rMjwh9A96JPQ9aO8MwmsSWWk5ARis5AmIl4Xg6nDO67jhyokqenjq7eDy4pbPQ1lhqPTKdystp1YAAIABAACAAgAAgAAAAAADAAAAIQdzblcpAP4SUliaIUPI88efcaBBLSNTr3VelwHHgmlKAjkBKaW0kVCQFi11mv0&#x2F;4Pk&#x2F;ozJgVtC0CIy5M8rngmy42Cx3Ky2nVgAAgAEAAIADAACAAAAAAAMAAAAA&lt;&#x2F;pre&gt;

* Case: PSBT with one P2TR script path only input with dummy internal key, scripts, script key derivation paths, merkle root, and script path signatures
** Bytes in Hex: &lt;pre&gt;70736274ff01005e02000000019bd48765230bf9a72e662001f972556e54f0c6f97feb56bcb5600d817f6995260100000000ffffffff0148e6052a0100000022512083698e458c6664e1595d75da2597de1e22ee97d798e706c4c0a4b5a9823cd743000000000001012b00f2052a01000000225120c2247efbfd92ac47f6f40b8d42d169175a19fa9fa10e4a25d7f35eb4dd85b69241142cb13ac68248de806aa6a3659cf3c03eb6821d09c8114a4e868febde865bb6d2cd970e15f53fc0c82f950fd560ffa919b76172be017368a89913af074f400b0940bf818d9757d6ffeb538ba057fb4c1fc4e0f5ef186e765beb564791e02af5fd3d5e2551d4e34e33d86f276b82c99c79aed3f0395a081efcd2cc2c65dd7e693d7941144320b0bf16f011b53ea7be615924aa7f27e5d29ad20ea1155d848676c3bad1b2115f2e490af7cc45c4f78511f36057ce5c5a5c56325a29fb44dfc203f356e1f840e1f1ab6fabfa26b236f21833719dc1d428ab768d80f91f9988d8abef47bfb863bb1f2a529f768c15f00ce34ec283cdc07e88f8428be28f6ef64043c32911811a4114fa0f7a3cef3b1d0c0a6ce7d26e17ada0b2e5c92d19efad48b41859cb8a451ca96f7d62059e9497a1a4a267569d9876da60101aff38e3529b9b939ce7f91ae97040ec1f0379206461c83342285423326708ab031f0da4a253ee45aafa5b8c92034d8b605490f8cd13e00f989989b97e215faa36f12dee3693d2daccf3781c1757f66215c150929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac06f7d62059e9497a1a4a267569d9876da60101aff38e3529b9b939ce7f91ae970115f2e490af7cc45c4f78511f36057ce5c5a5c56325a29fb44dfc203f356e1f823202cb13ac68248de806aa6a3659cf3c03eb6821d09c8114a4e868febde865bb6d2acc04215c150929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac097c6e6fea5ff714ff5724499990810e406e98aa10f5bf7e5f6784bc1d0a9a6ce23204320b0bf16f011b53ea7be615924aa7f27e5d29ad20ea1155d848676c3bad1b2acc06215c150929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0cd970e15f53fc0c82f950fd560ffa919b76172be017368a89913af074f400b09115f2e490af7cc45c4f78511f36057ce5c5a5c56325a29fb44dfc203f356e1f82320fa0f7a3cef3b1d0c0a6ce7d26e17ada0b2e5c92d19efad48b41859cb8a451ca9acc021162cb13ac68248de806aa6a3659cf3c03eb6821d09c8114a4e868febde865bb6d23901cd970e15f53fc0c82f950fd560ffa919b76172be017368a89913af074f400b09772b2da7560000800100008002000080000000000000000021164320b0bf16f011b53ea7be615924aa7f27e5d29ad20ea1155d848676c3bad1b23901115f2e490af7cc45c4f78511f36057ce5c5a5c56325a29fb44dfc203f356e1f8772b2da75600008001000080010000800000000000000000211650929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac005007c461e5d2116fa0f7a3cef3b1d0c0a6ce7d26e17ada0b2e5c92d19efad48b41859cb8a451ca939016f7d62059e9497a1a4a267569d9876da60101aff38e3529b9b939ce7f91ae970772b2da7560000800100008003000080000000000000000001172050929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0011820f0362e2f75a6f420a5bde3eb221d96ae6720cf25f81890c95b1d775acb515e65000105201124da7aec92ccd06c954562647f437b138b95721a84be2bf2276bbddab3e67121071124da7aec92ccd06c954562647f437b138b95721a84be2bf2276bbddab3e6711900772b2da7560000800100008000000080000000000500000000&lt;&#x2F;pre&gt;
** Base64 String: &lt;pre&gt;cHNidP8BAF4CAAAAAZvUh2UjC&#x2F;mnLmYgAflyVW5U8Mb5f+tWvLVgDYF&#x2F;aZUmAQAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;AUjmBSoBAAAAIlEgg2mORYxmZOFZXXXaJZfeHiLul9eY5wbEwKS1qYI810MAAAAAAAEBKwDyBSoBAAAAIlEgwiR++&#x2F;2SrEf29AuNQtFpF1oZ+p+hDkol1&#x2F;NetN2FtpJBFCyxOsaCSN6AaqajZZzzwD62gh0JyBFKToaP696GW7bSzZcOFfU&#x2F;wMgvlQ&#x2F;VYP+pGbdhcr4Bc2iomROvB09ACwlAv4GNl1fW&#x2F;+tTi6BX+0wfxOD17xhudlvrVkeR4Cr1&#x2F;T1eJVHU404z2G8na4LJnHmu0&#x2F;A5Wgge&#x2F;NLMLGXdfmk9eUEUQyCwvxbwEbU+p75hWSSqfyfl0prSDqEVXYSGdsO60bIRXy5JCvfMRcT3hRHzYFfOXFpcVjJaKftE38ID81bh+EDh8atvq&#x2F;omsjbyGDNxncHUKKt2jYD5H5mI2KvvR7+4Y7sfKlKfdowV8AzjTsKDzcB+iPhCi+KPbvZAQ8MpEYEaQRT6D3o87zsdDAps59JuF62gsuXJLRnvrUi0GFnLikUcqW99YgWelJehpKJnVp2YdtpgEBr&#x2F;OONSm5uTnOf5GulwQOwfA3kgZGHIM0IoVCMyZwirAx8NpKJT7kWq+luMkgNNi2BUkPjNE+APmJmJuX4hX6o28S3uNpPS2szzeBwXV&#x2F;ZiFcFQkpt0waBJVLeLS2A16XpeB4paDyjsltVHv+6azoA6wG99YgWelJehpKJnVp2YdtpgEBr&#x2F;OONSm5uTnOf5GulwEV8uSQr3zEXE94UR82BXzlxaXFYyWin7RN&#x2F;CA&#x2F;NW4fgjICyxOsaCSN6AaqajZZzzwD62gh0JyBFKToaP696GW7bSrMBCFcFQkpt0waBJVLeLS2A16XpeB4paDyjsltVHv+6azoA6wJfG5v6l&#x2F;3FP9XJEmZkIEOQG6YqhD1v35fZ4S8HQqabOIyBDILC&#x2F;FvARtT6nvmFZJKp&#x2F;J+XSmtIOoRVdhIZ2w7rRsqzAYhXBUJKbdMGgSVS3i0tgNel6XgeKWg8o7JbVR7&#x2F;ums6AOsDNlw4V9T&#x2F;AyC+VD9Vg&#x2F;6kZt2FyvgFzaKiZE68HT0ALCRFfLkkK98xFxPeFEfNgV85cWlxWMlop+0TfwgPzVuH4IyD6D3o87zsdDAps59JuF62gsuXJLRnvrUi0GFnLikUcqazAIRYssTrGgkjegGqmo2Wc88A+toIdCcgRSk6Gj+vehlu20jkBzZcOFfU&#x2F;wMgvlQ&#x2F;VYP+pGbdhcr4Bc2iomROvB09ACwl3Ky2nVgAAgAEAAIACAACAAAAAAAAAAAAhFkMgsL8W8BG1Pqe+YVkkqn8n5dKa0g6hFV2EhnbDutGyOQERXy5JCvfMRcT3hRHzYFfOXFpcVjJaKftE38ID81bh+HcrLadWAACAAQAAgAEAAIAAAAAAAAAAACEWUJKbdMGgSVS3i0tgNel6XgeKWg8o7JbVR7&#x2F;ums6AOsAFAHxGHl0hFvoPejzvOx0MCmzn0m4XraCy5cktGe+tSLQYWcuKRRypOQFvfWIFnpSXoaSiZ1admHbaYBAa&#x2F;zjjUpubk5zn+RrpcHcrLadWAACAAQAAgAMAAIAAAAAAAAAAAAEXIFCSm3TBoElUt4tLYDXpel4HiloPKOyW1Ue&#x2F;7prOgDrAARgg8DYuL3Wm9CClvePrIh2WrmcgzyX4GJDJWx13WstRXmUAAQUgESTaeuySzNBslUViZH9DexOLlXIahL4r8idrvdqz5nEhBxEk2nrskszQbJVFYmR&#x2F;Q3sTi5VyGoS+K&#x2F;Ina73as+ZxGQB3Ky2nVgAAgAEAAIAAAACAAAAAAAUAAAAA&lt;&#x2F;pre&gt;

==Rationale==

&lt;references&#x2F;&gt;

==Reference implementation==

The reference implementation of the PSBT format is available at https:&#x2F;&#x2F;github.com&#x2F;achow101&#x2F;bitcoin&#x2F;tree&#x2F;taproot-psbt.

==Acknowledgements==

TBD
</code></pre>

        </article>
    </div>


            <hr class="border-slate-700" />

            <div data-pagefind-ignore class="w-full flex flex-col items-center space-y-2 text-center">
                <div class="flex items-center space-x-2">
                    <p class="font-bold">Updated</p>
                    <p class="font-bold">2025-11-02</p>
                </div>
                <p>See an issue with rendering or formatting? Submit an issue on <a href="https://github.com/nickmonad/bips.dev" target="_blank">GitHub</a></p>
                <p>Do you find this site useful? Please consider <a href="https://buy.tryspeed.com/plink_live_lyek4a2yW2Sn2wfA" target="_blank">donating</a> some sats to support ongoing development.</p>
                <p><a href="/">bips.dev</a> is presented by <a href="https://nickmonad.blog" target="_blank">nickmonad</a></p>
                <p class="pt-4 text-sm">All content is owned and licensed by the respective author(s). This website makes no claim of ownership.</p>
            </div>
        </div>
    </div>
</body>
</html>
